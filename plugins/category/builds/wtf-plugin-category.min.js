!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n(require("https")):"function"==typeof define&&define.amd?define(["https"],n):(t=t||self).wtf=n(t.https)}(this,(function(t){"use strict";function n(t,n,e,r,o,i,u){try{var a=t[i](u),c=a.value}catch(t){return void e(t)}a.done?n(c):Promise.resolve(c).then(r,o)}function e(t){return function(){var e=this,r=arguments;return new Promise((function(o,i){var u=t.apply(e,r);function a(t){n(u,o,i,a,c,"next",t)}function c(t){n(u,o,i,a,c,"throw",t)}a(void 0)}))}}t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t;var r=function(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;return new Promise((function(r,o){if(t&&n)if(0!==t.length)for(var i=[],u=e-1,a=0,c=function e(c){a+=1;var f=n(t[c]);f.then?(f.then((function(t){i[c]=t})),f.catch((function(t){console.error(t),i[c]=null})),f.finally((function(){a-=1,u+=1,t.length>=u+1?e(u):a<=0&&r(i)}))):o("Error: function must return a promise")},f=t.length<e?t.length:e,s=0;s<f;s+=1)c(s);else r([]);else o("Error: missing required parameters to rate-limit function")}))},o={one:function(t,n){return r(t,n,1)},two:function(t,n){return r(t,n,2)},three:function(t,n){return r(t,n,3)},four:function(t,n){return r(t,n,4)},five:function(t,n){return r(t,n,5)},ten:function(t,n){return r(t,n,10)},fifteen:function(t,n){return r(t,n,15)}};o.serial=o.one,o.linear=o.one,o.crawl=o.three,o.walk=o.five,o.run=o.ten,o.sprint=o.fifteen;var i=o,u=function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(r,o){t.get(n,e,(function(t){var n="";t.on("data",(function(t){n+=t})),t.on("end",(function(){try{var t=JSON.parse(n);r(t)}catch(t){o(t)}}))})).on("error",(function(t){o(t)}))}))},a=function(t){var n=t.userAgent||t["User-Agent"]||t["Api-User-Agent"]||"User of the wtf_wikipedia library";return{method:"GET",headers:{"Content-Type":"application/json","Api-User-Agent":n,"User-Agent":n,Origin:"*"},redirect:"follow"}},c={lang:"en",wiki:"wikipedia",domain:null,path:"w/api.php"},f=function(t,n){var e;n=n||{},n=Object.assign({},c,n),"string"==typeof t?n.lang=t:(e=t)&&"[object Object]"===Object.prototype.toString.call(e)&&(n=Object.assign(n,t));var r="https://".concat(n.lang,".wikipedia.org/").concat(n.path,"?");n.domain&&(r="https://".concat(n.domain,"/").concat(n.path,"?")),r+="format=json&action=query&generator=random&grnnamespace=14&prop=revisions&grnlimit=1&origin=*";var o=a(n);return u(r,o).then((function(t){try{var n=t.query.pages;return n[Object.keys(n)[0]].title}catch(t){throw t}})).catch((function(t){return console.error(t),null}))};var s,p=(s=Object.freeze({__proto__:null,default:i}))&&s.default||s,l=function(t){var n,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,r=[];for(n=0;n<t.length;n+=e)r.push(t.slice(n,n+e));return r},h=function(){var t=e(regeneratorRuntime.mark((function t(n,e,r,o){var i,u,a,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return",{docs:[],categories:[]});case 2:return t.next=4,n.category(e,r);case 4:return i=t.sent,u=i.pages.map((function(t){return t.title})),a=l(u),c=function(t){return n.fetch(t,o)},t.abrupt("return",p.three(a,c).then((function(t){return{docs:[].concat.apply([],t),categories:i.categories}})));case 9:case"end":return t.stop()}}),t)})));return function(n,e,r,o){return t.apply(this,arguments)}}();return function(t){t.wtf.parseCategory=function(){var n=e(regeneratorRuntime.mark((function n(e,r,o){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,h(t.wtf,e,r,o);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)})));return function(t,e,r){return n.apply(this,arguments)}}(),t.wtf.randomCategory=function(){var t=e(regeneratorRuntime.mark((function t(n,e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f(n,e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(n,e){return t.apply(this,arguments)}}(),t.wtf.fetchCategory=t.wtf.parseCategory}}));
