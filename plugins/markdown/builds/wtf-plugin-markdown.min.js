!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t=t||self).wtf=n()}(this,(function(){"use strict";var t={redirects:!0,infoboxes:!0,templates:!0,sections:!0},n=function(n){n=Object.assign({},t,n);var e,r,i=this.data,a="";return!0===n.redirects&&!0===this.isRedirect()?(e=this.redirectTo(),r="./"+(r=e.page).replace(/ /g,"_"),e.anchor&&(r+="#"+e.anchor),"↳ [".concat(e.text,"](").concat(r,")")):(!0===n.infoboxes&&!0===n.templates&&(a+=this.infoboxes().map((function(t){return t.markdown(n)})).join("\n\n")),!0!==n.sections&&!0!==n.paragraphs&&!0!==n.sentences||(a+=i.sections.map((function(t){return t.markdown(n)})).join("\n\n")),!0===n.references&&(a+="## References",a+=this.citations().map((function(t){return t.json(n)})).join("\n")),a)},e={headers:!0,images:!0,tables:!0,lists:!0,paragraphs:!0},r=function(t){var n="";if(!0===(t=Object.assign({},e,t)).headers&&this.title()){for(var r="##",i=0;i<this.depth;i+=1)r+="#";n+=r+" "+this.title()+"\n"}if(!0===t.images){var a=this.images();a.length>0&&(n+=a.map((function(t){return t.markdown()})).join("\n"),n+="\n")}if(!0===t.tables){var o=this.tables();o.length>0&&(n+="\n",n+=o.map((function(n){return n.markdown(t)})).join("\n"),n+="\n")}if(!0===t.lists){var s=this.lists();s.length>0&&(n+=s.map((function(n){return n.markdown(t)})).join("\n"),n+="\n")}return!0!==t.paragraphs&&!0!==t.sentences||(n+=this.paragraphs().map((function(n){return n.sentences().map((function(n){return n.markdown(t)})).join(" ")})).join("\n\n")),n},i={sentences:!0},a=function(t){var n="";return!0===(t=Object.assign({},i,t)).sentences&&(n+=this.sentences().reduce((function(n,e){return n+=e.markdown(t)+"\n"}),{})),n};var o=function(t,n,e){if(!n||!t)return t;"number"==typeof t&&(t=String(t)),n=n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var r=new RegExp("\\b"+n+"\\b");return t=!0===r.test(t)?t.replace(r,e):t.replace(n,e)},s={links:!0,formatting:!0},c=function(t){t=Object.assign({},s,t);var n=this.text();return!0===t.links&&this.links().forEach((function(t){var e=t.markdown(),r=t.text()||t.page();n=o(n,r,e)})),!0===t.formatting&&(this.bold().forEach((function(t){n=o(n,t,"**"+t+"**")})),this.italic().forEach((function(t){n=o(n,t,"*"+t+"*")}))),n},u=function(t){return t&&"string"==typeof t?t.charAt(0).toUpperCase()+t.slice(1):""},f=function(){var t="";return this.site()?t=this.site():(t="./"+(t=u(this.page())).replace(/ /g,"_"),this.anchor()&&(t+="#".concat(this.anchor()))),"["+(this.text()||this.page())+"]("+t+")"},h=function(){var t=this.data.file.replace(/^(file|image):/i,"");return"!["+(t=t.replace(/\.(jpg|jpeg|png|gif|svg)/i,""))+"]("+this.thumbnail()+")"},p=function(t,n){t=t||"";var e=(n=n||15)-(t=String(t)).length;e=Math.ceil(e/2);for(var r=0;r<e;r+=1)(t=" "+t).length<n&&(t+=" ");return t},d={image:!0,caption:!0,alt:!0,signature:!0,"signature alt":!0},l={images:!0},m=function(t){var n=this;t=Object.assign({},l,t);var e="|"+p("",35)+"|"+p("",30)+"|\n";return e+="|"+p("---",35)+"|"+p("---",30)+"|\n",Object.keys(this.data).forEach((function(r){if(!0!==d[r]){var i="**"+r+"**",a=n.data[r].markdown(t);a=a.split(/\n/g).join(", "),e+="|"+p(i,35)+"|"+p(a,30)+" |\n"}})),e},g=function(t){return this.lines().map((function(n){return" * "+n.markdown(t)})).join("\n")},k=function(){if(this.data&&this.data.url&&this.data.title)return"⌃ [".concat(this.data.title,"](").concat(this.data.url,")");if(this.data.encyclopedia)return"⌃ ".concat(this.data.encyclopedia);if(this.data.title){var t=this.data.title;return this.data.author&&(t+=this.data.author),this.data.first&&this.data.last&&(t+=this.data.first+" "+this.data.last),"⌃ ".concat(t)}return this.inline?"⌃ ".concat(this.inline.markdown()):""},v=function(t){return"| "+(t=t.map((function(t){return p(t,14)}))).join(" | ")+" |"},w=function(t){var n="";if(!this||0===this.length)return n;var e=Object.keys(this[0]),r=e.map((function(t){return!0===/^col[0-9]/.test(t)?"":t}));return n+=v(r)+"\n",n+=v(r.map((function(){return"---"})))+"\n",(n+=this.map((function(n){var r=e.map((function(e){return n[e]&&n[e].markdown(t)||""}));return v(r)})).join("\n"))+"\n"};return function(t){t.Doc.prototype.markdown=n,t.Section.prototype.markdown=r,t.Paragraph.prototype.markdown=a,t.Sentence.prototype.markdown=c,t.Link.prototype.markdown=f,t.Image.prototype.markdown=h,t.Infobox.prototype.markdown=m,t.Table.prototype.markdown=w,t.List.prototype.markdown=g,t.Reference.prototype.markdown=k}}));
